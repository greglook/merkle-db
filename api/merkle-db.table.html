<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>merkle-db.table documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Merkle-db</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="api.html"><div class="inner"><span>Client API</span></div></a></li><li class="depth-1 "><a href="design.html"><div class="inner"><span>Structural Design</span></div></a></li><li class="depth-1 "><a href="indexing.html"><div class="inner"><span>Index Tree Algorithms</span></div></a></li><li class="depth-1 "><a href="usage.html"><div class="inner"><span>Usage Patterns</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>merkle-db</span></div></div></li><li class="depth-2 branch"><a href="merkle-db.bloom.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bloom</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.connection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>connection</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.graph.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graph</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.index.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>index</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.key.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>key</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.partition.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>partition</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.patch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>patch</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.record.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>record</span></div></a></li><li class="depth-2 branch current"><a href="merkle-db.table.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>table</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.tablet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tablet</span></div></a></li><li class="depth-2"><a href="merkle-db.validate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validate</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="merkle-db.table.html#var-data-type"><div class="inner"><span>data-type</span></div></a></li><li class="depth-1"><a href="merkle-db.table.html#var-dirty.3F"><div class="inner"><span>dirty?</span></div></a></li><li class="depth-1"><a href="merkle-db.table.html#var-ITable"><div class="inner"><span>ITable</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-delete"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>delete</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-flush.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>flush!</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-insert"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>insert</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-keys"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>keys</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-list-partitions"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>list-partitions</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-read"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>read</span></div></a></li><li class="depth-2 branch"><a href="merkle-db.table.html#var-read-partition"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>read-partition</span></div></a></li><li class="depth-2"><a href="merkle-db.table.html#var-scan"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scan</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">merkle-db.table</h1><div class="doc"><div class="markdown"><p>Tables are named top-level containers of records. Generally, a single table corresponds to a certain ‘kind’ of data. Tables also contain configuration determining how keys are encoded and records are stored.</p></div></div><div class="public anchor" id="var-data-type"><h3>data-type</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Value of <code>:data/type</code> that indicates a table root node.</p></div></div><div class="src-link"><a href="https://github.com/greglook/merkle-db/blob/master/src/merkle_db/table.clj#L23">view source</a></div></div><div class="public anchor" id="var-dirty.3F"><h3>dirty?</h3><div class="usage"><code>(dirty? table)</code></div><div class="doc"><div class="markdown"><p>Return true if the table has local non-persisted modifications.</p></div></div><div class="src-link"><a href="https://github.com/greglook/merkle-db/blob/master/src/merkle_db/table.clj#L422">view source</a></div></div><div class="public anchor" id="var-ITable"><h3>ITable</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Protocol for an immutable table of record data.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-delete"><h3>delete</h3><div class="usage"><code>(delete table id-keys)</code></div><div class="doc"><div class="markdown"><p>Remove some records from the table, identified by a collection of id keys. Returns an updated table.</p></div></div></div><div class="public anchor" id="var-flush.21"><h3>flush!</h3><div class="usage"><code>(flush! table)</code><code>(flush! table opts)</code></div><div class="doc"><div class="markdown"><p>Ensure that all local state has been persisted to the storage backend. Returns an updated persisted table.</p>
<p>Options may include:</p>
<ul>
  <li><code>:apply-patch?</code>  If true, the current patch data will be merged into the main data tree  and the returned table will have no patch link.</li>
</ul></div></div></div><div class="public anchor" id="var-insert"><h3>insert</h3><div class="usage"><code>(insert table records)</code><code>(insert table records opts)</code></div><div class="doc"><div class="markdown"><p>Insert some record data into the database, represented by a collection of pairs of record key values and field maps. Returns an updated table.</p>
<p>Options may include:</p>
<ul>
  <li><code>:merge-field</code>  A function which will be called with <code>(f field-key old-val new-val)</code>, and  should return the new value to use for that field. By default, <code>new-val</code>  is used directly.</li>
  <li><code>:merge-record</code>  A function which will be called with <code>(f record-key old-data new-data)</code>,  and should return the data map to use for the record. By default, this  merges the data maps and removes nil-valued fields.</li>
</ul></div></div></div><div class="public anchor" id="var-keys"><h3>keys</h3><div class="usage"><code>(keys table)</code><code>(keys table opts)</code></div><div class="doc"><div class="markdown"><p>Scan the table, returning keys of the stored records which match the given options. Returns a lazy sequence of keys, or nil if the table is empty.</p>
<p>If min and max keys are given, only records within the bounds will be returned (inclusive). A nil min or max implies the beginning or end of the data, respectively.</p>
<p>Options may include:</p>
<ul>
  <li><code>:min-key</code>  Return records with keys equal to or greater than the marker.</li>
  <li><code>:max-key</code>  Return records with keys equal to or less than the marker.</li>
  <li><code>:reverse</code>  Reverse the order the keys are returned in.</li>
  <li><code>:offset</code>  Skip this many records in the output.</li>
  <li><code>:limit</code>  Return at most this many records.</li>
</ul></div></div></div><div class="public anchor" id="var-list-partitions"><h3>list-partitions</h3><div class="usage"><code>(list-partitions table)</code></div><div class="doc"><div class="markdown"><p>List the partitions which comprise the table. Returns a sequence of partition nodes.</p></div></div></div><div class="public anchor" id="var-read"><h3>read</h3><div class="usage"><code>(read table id-keys)</code><code>(read table id-keys opts)</code></div><div class="doc"><div class="markdown"><p>Read a set of records from the database, returning data for each present record. Returns a sequence of vectors which each hold a record key and a map of the record data, or nil if no records were found.</p>
<p>Options may include:</p>
<ul>
  <li><code>:fields</code>  Only return data for the selected set of fields. If provided, only  records with data for one or more of the fields are returned, otherwise  all fields and records are returned.</li>
</ul></div></div></div><div class="public anchor" id="var-read-partition"><h3>read-partition</h3><div class="usage"><code>(read-partition table partition-id opts)</code></div><div class="doc"><div class="markdown"><p>Read all the records in the identified partition.</p></div></div></div><div class="public anchor" id="var-scan"><h3>scan</h3><div class="usage"><code>(scan table)</code><code>(scan table opts)</code></div><div class="doc"><div class="markdown"><p>Scan the table, returning data from records which match the given options. Returns a lazy sequence of vectors which each hold a record key and a map of the record data, or nil if the table is empty.</p>
<p>If min and max keys or indices are given, only records within the bounds will be returned (inclusive). A nil min or max implies the beginning or end of the data, respectively.</p>
<p>Options may include:</p>
<ul>
  <li><code>:fields</code>  Only return data for the selected set of fields. If provided, only  records with data for one or more of the fields are returned, otherwise  all fields and records (including empty ones) are returned.</li>
  <li><code>:min-key</code>  Return records with keys equal to or greater than the marker.</li>
  <li><code>:max-key</code>  Return records with keys equal to or less than the marker.</li>
  <li><code>:reverse</code>  Reverse the order the keys are returned in.</li>
  <li><code>:offset</code>  Skip this many records in the output.</li>
  <li><code>:limit</code>  Return at most this many records.</li>
</ul></div></div></div></div></div><div class="src-link"><a href="https://github.com/greglook/merkle-db/blob/master/src/merkle_db/table.clj#L66">view source</a></div></div></div></body></html>